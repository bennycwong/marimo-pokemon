{
  "version": "1",
  "metadata": {
    "marimo_version": "0.18.0"
  },
  "cells": [
    {
      "id": "MJUe",
      "code_hash": "033e7bbf8be8fdda22206bb4d694a60a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"module-1-data-engineering-foundations\">Module 1: Data Engineering Foundations</h1>\n<span class=\"paragraph\"><strong>Welcome to your ML engineering journey!</strong></span>\n<span class=\"paragraph\">In this module, you'll learn that <strong>data engineering is the foundation of any ML system</strong>.\nIn industry, data engineering typically takes 60-80% of an ML engineer's time.</span>\n<h2 id=\"what-youll-learn\">What You'll Learn</h2>\n<ol>\n<li><strong>Treat Data as Code</strong>: Data deserves the same rigor as application code</li>\n<li><strong>Data Quality</strong>: Identify and fix data quality issues systematically</li>\n<li><strong>Reproducibility</strong>: Build pipelines that produce identical results</li>\n<li><strong>Performance</strong>: Compare pandas vs polars for different scenarios</li>\n</ol>\n<h2 id=\"industry-context\">Industry Context</h2>\n<blockquote>\n<span class=\"paragraph\">\"If I had an hour to solve a problem, I'd spend 55 minutes on data quality and 5 minutes on the model.\"\n\u2014 Adapted from Einstein, but every ML engineer agrees</span>\n</blockquote>\n<span class=\"paragraph\"><strong>Why data engineering matters:</strong></span>\n<ul>\n<li>Bad data \u2192 Bad models (no matter how sophisticated your algorithm)</li>\n<li>Data bugs are hard to detect (model trains successfully, but learns wrong patterns)</li>\n<li>Production failures are usually data issues, not model issues</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "0a4ab0d7b08247d86779fb2c29e683fa",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><hr />\n<h2 id=\"section-1-loading-data-the-right-way\">Section 1: Loading Data (The Right Way)</h2>\n<span class=\"paragraph\">Let's start by loading our Pokemon card dataset. But we won't just load it \u2014\nwe'll do it <strong>professionally</strong> with proper validation and error handling.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "SFPL",
      "code_hash": "a41ad93ab21d9f014bde1c2b28ebd502",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"initial-data-exploration\">\ud83d\udcca Initial Data Exploration</h3>\n<span class=\"paragraph\">Before we do anything else, let's understand what we're working with.\nThis is called <strong>Exploratory Data Analysis (EDA)</strong>, though for now we're just getting oriented.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "5167ac4cd886391c2f55c057219becbb",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"did-you-notice-anything-wrong\">\ud83d\udea8 Did You Notice Anything Wrong?</h3>\n<span class=\"paragraph\">Look at the <code>.info()</code> output above carefully:</span>\n<ul>\n<li><code>hp</code>: 784 non-null out of 800 \u2192 <strong>16 missing values</strong></li>\n<li><code>price_usd</code>: 776 non-null out of 800 \u2192 <strong>24 missing values</strong></li>\n</ul>\n<span class=\"paragraph\"><strong>This is realistic!</strong> Real-world datasets are messy. Let's investigate further.</span>\n<hr />\n<h2 id=\"section-2-data-quality-issues\">Section 2: Data Quality Issues</h2>\n<span class=\"paragraph\">Now let's systematically check for common data quality problems:</span>\n<ol>\n<li>Missing values</li>\n<li>Duplicate records</li>\n<li>Inconsistent values (e.g., capitalization)</li>\n<li>Outliers</li>\n<li>Data type issues</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "iLit",
      "code_hash": "87630f2006ac1a4991d98bf917becbda",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"industry-insight-data-quality-issues-are-normal\">\ud83d\udca1 Industry Insight: Data Quality Issues are Normal</h3>\n<span class=\"paragraph\"><strong>What we found:</strong></span>\n<ul>\n<li>\u2705 Missing values in HP and price</li>\n<li>\u2705 Duplicate card IDs (data entry errors)</li>\n<li>\u2705 Inconsistent capitalization in <code>type</code> column</li>\n<li>\u2705 Price outliers (some cards 10x more expensive)</li>\n</ul>\n<span class=\"paragraph\"><strong>In production, you'll see:</strong></span>\n<ul>\n<li>Database connection failures \u2192 missing data</li>\n<li>Multiple data sources \u2192 inconsistent formats</li>\n<li>Manual data entry \u2192 typos and duplicates</li>\n<li>Edge cases \u2192 outliers that break models</li>\n</ul>\n<span class=\"paragraph\"><strong>The key question:</strong> Are these errors, or valid data points?</span>\n<ul>\n<li>Duplicates: Probably errors</li>\n<li>Missing values: Depends (could be \"unknown\" vs \"not collected\")</li>\n<li>Outliers: Rare cards ARE expensive (domain knowledge!)</li>\n<li>Inconsistent case: Definitely an error</li>\n</ul>\n<hr />\n<h2 id=\"section-3-data-validation-with-pandera\">Section 3: Data Validation with Pandera</h2>\n<span class=\"paragraph\">Manual checks are good for exploration, but in production we need <strong>automated validation</strong>.\nLet's use <strong>Pandera</strong> to define a schema that our data must conform to.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "TqIu",
      "code_hash": "72a380bc0da32fd50c8b0cbc94963255",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"data-cleaning-pipeline\">\ud83d\udd27 Data Cleaning Pipeline</h3>\n<span class=\"paragraph\">Now that we know what's wrong, let's fix it systematically.\nWe'll create a <strong>data cleaning pipeline</strong> that's:</span>\n<ul>\n<li>Reproducible (same input \u2192 same output)</li>\n<li>Documented (each step has a clear purpose)</li>\n<li>Testable (we can verify it works)</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ecfG",
      "code_hash": "d7c58253a38a005c78b667a84b3ae49c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><hr />\n<h2 id=\"section-4-data-versioning-reproducibility\">Section 4: Data Versioning &amp; Reproducibility</h2>\n<span class=\"paragraph\"><strong>Key Question</strong>: If you run this pipeline tomorrow, will you get the same result?</span>\n<span class=\"paragraph\">In production, we need:</span>\n<ul>\n<li><strong>Data versioning</strong>: Track which version of data produced which model</li>\n<li><strong>Pipeline versioning</strong>: Track the code that processed the data</li>\n<li><strong>Reproducibility</strong>: Ability to recreate any past result</li>\n</ul>\n<h3 id=\"tools-in-industry\">Tools in Industry:</h3>\n<ul>\n<li><strong>DVC (Data Version Control)</strong>: Git for data</li>\n<li><strong>MLflow</strong>: Track experiments with data versions</li>\n<li><strong>Feast</strong>: Feature store for versioned features</li>\n<li><strong>Delta Lake</strong>: Versioned data lake storage</li>\n</ul>\n<span class=\"paragraph\">For this project, we'll use simple approaches that scale up.</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ZBYS",
      "code_hash": "fc7545e43b6b0cdd917923d057057161",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><hr />\n<h2 id=\"section-5-performance-comparison-pandas-vs-polars\">Section 5: Performance Comparison - Pandas vs Polars</h2>\n<span class=\"paragraph\">You've heard about <strong>Polars</strong> - the fast new DataFrame library written in Rust.\nLet's compare it to pandas for our use case.</span>\n<h3 id=\"when-to-use-each\">When to use each:</h3>\n<ul>\n<li><strong>pandas</strong>: &lt;10GB data, lots of libraries expect pandas, exploratory work</li>\n<li><strong>polars</strong>: &gt;10GB data, performance critical, parallel processing needed</li>\n</ul>\n<span class=\"paragraph\">Let's run a performance comparison!</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "xXTn",
      "code_hash": "d369c216ceb4d6549a877f332caef42a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"should-you-switch-to-polars\">\ud83e\udd14 Should You Switch to Polars?</h3>\n<span class=\"paragraph\"><strong>Not necessarily!</strong> Consider:</span>\n<span class=\"paragraph\"><strong>Stick with pandas if:</strong></span>\n<ul>\n<li>Your data is &lt;1GB</li>\n<li>You're doing exploratory analysis</li>\n<li>You need compatibility with scikit-learn, matplotlib, etc.</li>\n<li>Your team knows pandas well</li>\n</ul>\n<span class=\"paragraph\"><strong>Use polars if:</strong></span>\n<ul>\n<li>Data is &gt;10GB</li>\n<li>Performance is critical</li>\n<li>You're building data pipelines</li>\n<li>You can handle the learning curve</li>\n</ul>\n<span class=\"paragraph\"><strong>In this course</strong>: We'll use pandas (industry standard, better ecosystem),\nbut you now know polars exists for when you need it!</span>\n<hr />\n<h2 id=\"section-6-key-takeaways-socratic-questions\">Section 6: Key Takeaways &amp; Socratic Questions</h2>\n<h3 id=\"what-you-learned\">\u2705 What You Learned</h3>\n<ol>\n<li><strong>Data quality matters more than algorithms</strong></li>\n<li><strong>Always validate your data</strong> (use schemas like Pandera)</li>\n<li><strong>Build reproducible pipelines</strong> (version everything)</li>\n<li><strong>Performance tools exist</strong> (polars) but choose wisely</li>\n<li><strong>Document and test your data code</strong> (it's real code!)</li>\n</ol>\n<h3 id=\"socratic-questions-test-your-understanding\">\ud83e\udd14 Socratic Questions (Test Your Understanding)</h3>\n<span class=\"paragraph\">Try to answer these before moving on:</span>\n<ol>\n<li>\n<span class=\"paragraph\"><strong>\"If I run your data pipeline twice on the same input, will I get identical output? Why or why not?\"</strong></span>\n<ul>\n<li>Think about: random operations, timestamps, external dependencies</li>\n</ul>\n</li>\n<li>\n<span class=\"paragraph\"><strong>\"Your model performed great in training but fails in production. The data looks similar. What could be wrong?\"</strong></span>\n<ul>\n<li>Think about: data drift, schema changes, missing values handled differently</li>\n</ul>\n</li>\n<li>\n<span class=\"paragraph\"><strong>\"Someone changed a column name upstream. How would you detect this before it breaks your model?\"</strong></span>\n<ul>\n<li>Think about: schema validation, automated tests, monitoring</li>\n</ul>\n</li>\n<li>\n<span class=\"paragraph\"><strong>\"When would you choose polars over pandas? When would you stick with pandas?\"</strong></span>\n<ul>\n<li>Think about: data size, team skills, ecosystem compatibility</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"practice-exercise\">\ud83c\udfcb\ufe0f Practice Exercise</h3>\n<span class=\"paragraph\">Before moving to Module 2, try this:</span>\n<span class=\"paragraph\"><strong>Exercise</strong>: You receive a new Pokemon dataset with a different schema (missing columns, extra columns).\nModify the cleaning pipeline to handle this gracefully.</span>\n<span class=\"paragraph\">Hints:</span>\n<ul>\n<li>Update the Pandera schema</li>\n<li>Add checks for required columns</li>\n<li>Handle missing features with defaults</li>\n</ul>\n<hr />\n<h2 id=\"industry-context-real-world-data-engineering\">\ud83c\udfe2 Industry Context: Real-World Data Engineering</h2>\n<h3 id=\"how-companies-do-this-at-scale\">How Companies Do This at Scale</h3>\n<span class=\"paragraph\"><strong>Small Startup (&lt;10 models)</strong>:</span>\n<ul>\n<li>Simple CSV files in S3/GCS</li>\n<li>Python scripts for cleaning</li>\n<li>Basic validation</li>\n</ul>\n<span class=\"paragraph\"><strong>Medium Company (10-50 models)</strong>:</span>\n<ul>\n<li>Data warehouse (Snowflake, BigQuery)</li>\n<li>Airflow for orchestration</li>\n<li>Great Expectations for validation</li>\n<li>Basic feature store (Feast)</li>\n</ul>\n<span class=\"paragraph\"><strong>Large Company (&gt;50 models)</strong>:</span>\n<ul>\n<li>Custom data platform</li>\n<li>Real-time + batch pipelines</li>\n<li>Feature stores (Tecton, internal)</li>\n<li>Data quality monitoring</li>\n<li>Automated alerting</li>\n</ul>\n<h3 id=\"common-pitfalls-to-avoid\">Common Pitfalls to Avoid</h3>\n<span class=\"paragraph\">\u26a0\ufe0f <strong>Don't</strong>: Load data without validation\n\u2705 <strong>Do</strong>: Define schemas and validate automatically</span>\n<span class=\"paragraph\">\u26a0\ufe0f <strong>Don't</strong>: Clean data in notebooks without saving the code\n\u2705 <strong>Do</strong>: Write reusable cleaning functions with tests</span>\n<span class=\"paragraph\">\u26a0\ufe0f <strong>Don't</strong>: Ignore missing values\n\u2705 <strong>Do</strong>: Understand why they're missing and handle appropriately</span>\n<span class=\"paragraph\">\u26a0\ufe0f <strong>Don't</strong>: Assume your data is correct\n\u2705 <strong>Do</strong>: Be paranoid - validate everything</span>\n<hr />\n<h2 id=\"module-1-checkpoint\">\ud83c\udfaf Module 1 Checkpoint</h2>\n<span class=\"paragraph\">You've completed Module 1 when you can:</span>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled/> Write a data validation test from scratch in &lt;10 minutes</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled/> Explain why data versioning matters to a junior engineer</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled/> Debug a data quality issue by reading test failures</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled/> Choose the right tool (pandas/polars/SQL) for a given task</li>\n</ul>\n<span class=\"paragraph\"><strong>Next</strong>: Module 2 - EDA &amp; Feature Engineering</span>\n<span class=\"paragraph\">In the next module, you'll learn how to:</span>\n<ul>\n<li>Explore data to extract insights</li>\n<li>Engineer features that improve model performance</li>\n<li>Avoid data leakage (the silent killer)</li>\n<li>Build scikit-learn preprocessing pipelines</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hbol",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "bkHC",
      "code_hash": "193f8158b35bc029b41414bc63aa2e4d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "674cd5a0f94e06958acac4f6f985e334",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u2705 Loaded 16000 Pokemon cards\n\u2705 Dataset shape: 16000 rows \u00d7 13 columns\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "PKri",
      "code_hash": "48f048ae85cb78713fef84d0029ed008",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"first-look-at-the-data\">\ud83d\udd0d First Look at the Data</h3>\n<span class=\"paragraph\">We loaded <strong>16000 records</strong> with <strong>13 features</strong>.\nLet's examine the first few rows:</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "6f7f96cc5bbeaa0fccbc780d76f6a923",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='Xref-0' random-id='323c10a5-4542-7df8-a0b8-824ea81eace8'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;name&#92;&quot;:&#92;&quot;Solrock&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Psychic&#92;&quot;,&#92;&quot;hp&#92;&quot;:72,&#92;&quot;attack&#92;&quot;:70,&#92;&quot;defense&#92;&quot;:48,&#92;&quot;sp_attack&#92;&quot;:53,&#92;&quot;sp_defense&#92;&quot;:82,&#92;&quot;speed&#92;&quot;:79,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Rare&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Fossil&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:1.38},{&#92;&quot;name&#92;&quot;:&#92;&quot;Torchic&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Fire&#92;&quot;,&#92;&quot;hp&#92;&quot;:78,&#92;&quot;attack&#92;&quot;:47,&#92;&quot;defense&#92;&quot;:54,&#92;&quot;sp_attack&#92;&quot;:39,&#92;&quot;sp_defense&#92;&quot;:52,&#92;&quot;speed&#92;&quot;:33,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Uncommon&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Base Set 2&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:1.0},{&#92;&quot;name&#92;&quot;:&#92;&quot;Sneasel&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Dark&#92;&quot;,&#92;&quot;hp&#92;&quot;:85,&#92;&quot;attack&#92;&quot;:62,&#92;&quot;defense&#92;&quot;:77,&#92;&quot;sp_attack&#92;&quot;:69,&#92;&quot;sp_defense&#92;&quot;:68,&#92;&quot;speed&#92;&quot;:62,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Rare&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Jungle&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:1.31},{&#92;&quot;name&#92;&quot;:&#92;&quot;Ponyta EX&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Fire&#92;&quot;,&#92;&quot;hp&#92;&quot;:127,&#92;&quot;attack&#92;&quot;:104,&#92;&quot;defense&#92;&quot;:51,&#92;&quot;sp_attack&#92;&quot;:58,&#92;&quot;sp_defense&#92;&quot;:52,&#92;&quot;speed&#92;&quot;:50,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Rare Holo&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:true,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Jungle&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:12.47},{&#92;&quot;name&#92;&quot;:&#92;&quot;Azurill&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Fairy&#92;&quot;,&#92;&quot;hp&#92;&quot;:54,&#92;&quot;attack&#92;&quot;:38,&#92;&quot;defense&#92;&quot;:49,&#92;&quot;sp_attack&#92;&quot;:54,&#92;&quot;sp_defense&#92;&quot;:52,&#92;&quot;speed&#92;&quot;:63,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Uncommon&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Neo Discovery&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:0.33},{&#92;&quot;name&#92;&quot;:&#92;&quot;Tentacool&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Water&#92;&quot;,&#92;&quot;hp&#92;&quot;:42,&#92;&quot;attack&#92;&quot;:55,&#92;&quot;defense&#92;&quot;:54,&#92;&quot;sp_attack&#92;&quot;:46,&#92;&quot;sp_defense&#92;&quot;:36,&#92;&quot;speed&#92;&quot;:58,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Common&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Jungle&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:0.41},{&#92;&quot;name&#92;&quot;:&#92;&quot;Corsola&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Water&#92;&quot;,&#92;&quot;hp&#92;&quot;:66,&#92;&quot;attack&#92;&quot;:69,&#92;&quot;defense&#92;&quot;:42,&#92;&quot;sp_attack&#92;&quot;:87,&#92;&quot;sp_defense&#92;&quot;:46,&#92;&quot;speed&#92;&quot;:84,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Rare&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Gym Challenge&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:1.61},{&#92;&quot;name&#92;&quot;:&#92;&quot;Pignite&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Fire&#92;&quot;,&#92;&quot;hp&#92;&quot;:35,&#92;&quot;attack&#92;&quot;:69,&#92;&quot;defense&#92;&quot;:40,&#92;&quot;sp_attack&#92;&quot;:29,&#92;&quot;sp_defense&#92;&quot;:30,&#92;&quot;speed&#92;&quot;:32,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Common&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Gym Challenge&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:0.33},{&#92;&quot;name&#92;&quot;:&#92;&quot;Lotad&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Grass&#92;&quot;,&#92;&quot;hp&#92;&quot;:60,&#92;&quot;attack&#92;&quot;:44,&#92;&quot;defense&#92;&quot;:39,&#92;&quot;sp_attack&#92;&quot;:57,&#92;&quot;sp_defense&#92;&quot;:75,&#92;&quot;speed&#92;&quot;:51,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Uncommon&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Gym Challenge&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:0.44},{&#92;&quot;name&#92;&quot;:&#92;&quot;Swampert&#92;&quot;,&#92;&quot;type&#92;&quot;:&#92;&quot;Water&#92;&quot;,&#92;&quot;hp&#92;&quot;:100,&#92;&quot;attack&#92;&quot;:36,&#92;&quot;defense&#92;&quot;:66,&#92;&quot;sp_attack&#92;&quot;:73,&#92;&quot;sp_defense&#92;&quot;:53,&#92;&quot;speed&#92;&quot;:81,&#92;&quot;generation&#92;&quot;:1,&#92;&quot;rarity&#92;&quot;:&#92;&quot;Rare&#92;&quot;,&#92;&quot;is_legendary&#92;&quot;:false,&#92;&quot;set_name&#92;&quot;:&#92;&quot;Gym Heroes&#92;&quot;,&#92;&quot;price_usd&#92;&quot;:1.54}]&quot;' data-total-rows='10' data-total-columns='13' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='false' data-page-size='10' data-field-types='[[&quot;name&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;hp&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;attack&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;defense&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;sp_attack&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;sp_defense&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;speed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;generation&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;rarity&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;is_legendary&quot;,[&quot;boolean&quot;,&quot;bool&quot;]],[&quot;set_name&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;price_usd&quot;,[&quot;number&quot;,&quot;float64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "BYtC",
      "code_hash": "0c1e84674a65e0171dab94a9e5cf6ef5",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "============================================================\nDATASET INFORMATION\n============================================================\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 16000 entries, 0 to 15999\nData columns (total 13 columns):\n #   Column        Non-Null Count  Dtype  \n---  ------        --------------  -----  \n 0   name          16000 non-null  object \n 1   type          16000 non-null  object \n 2   hp            16000 non-null  int64  \n 3   attack        16000 non-null  int64  \n 4   defense       16000 non-null  int64  \n 5   sp_attack     16000 non-null  int64  \n 6   sp_defense    16000 non-null  int64  \n 7   speed         16000 non-null  int64  \n 8   generation    16000 non-null  int64  \n 9   rarity        16000 non-null  object \n 10  is_legendary  16000 non-null  bool   \n 11  set_name      16000 non-null  object \n 12  price_usd     16000 non-null  float64\ndtypes: bool(1), float64(1), int64(7), object(4)\nmemory usage: 1.5+ MB\n\n============================================================\nBASIC STATISTICS\n============================================================\n                 hp        attack       defense     sp_attack    sp_defense  \\\ncount  16000.000000  16000.000000  16000.000000  16000.000000  16000.000000   \nmean      77.432375     55.964687     60.215625     59.570312     60.618563   \nstd       36.666275     19.453350     21.073393     20.958578     21.400434   \nmin       30.000000     10.000000     10.000000     10.000000     10.000000   \n25%       53.000000     43.000000     46.000000     45.000000     46.000000   \n50%       71.000000     53.000000     57.000000     57.000000     57.000000   \n75%       91.000000     66.000000     71.000000     70.000000     72.000000   \nmax      251.000000    166.000000    183.000000    187.000000    178.000000   \n\n              speed    generation     price_usd  \ncount  16000.000000  16000.000000  16000.000000  \nmean      61.153750      4.275000     10.281799  \nstd       20.343103      2.307533     53.886034  \nmin       10.000000      1.000000      0.040000  \n25%       47.000000      2.000000      0.300000  \n50%       58.000000      4.000000      0.630000  \n75%       72.000000      6.000000      2.150000  \nmax      169.000000      9.000000   2391.530000  \n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "Kclp",
      "code_hash": "7614667d5789a4dc391f26041ff046b2",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "============================================================\nMISSING VALUE ANALYSIS\n============================================================\nEmpty DataFrame\nColumns: [Column, Missing Count, Missing %]\nIndex: []\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "emfo",
      "code_hash": "c07721b650dd18c2c82f2957450fded9",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "'card_id'",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/Users/benny.wong/.cache/uv/archive-v0/4URZ5lSNR81AX0mZB7D00/lib/python3.13/site-packages/pandas/core/indexes/base.py&quot;</span>, line <span class=\"m\">3812</span>, in <span class=\"n\">get_loc</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_engine</span><span class=\"o\">.</span><span class=\"n\">get_loc</span><span class=\"p\">(</span><span class=\"n\">casted_key</span><span class=\"p\">)</span>\n<span class=\"w\">           </span><span class=\"pm\">~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;pandas/_libs/index.pyx&quot;</span>, line <span class=\"m\">167</span>, in <span class=\"n\">pandas._libs.index.IndexEngine.get_loc</span>\n  File <span class=\"nb\">&quot;pandas/_libs/index.pyx&quot;</span>, line <span class=\"m\">196</span>, in <span class=\"n\">pandas._libs.index.IndexEngine.get_loc</span>\n  File <span class=\"nb\">&quot;pandas/_libs/hashtable_class_helper.pxi&quot;</span>, line <span class=\"m\">7088</span>, in <span class=\"n\">pandas._libs.hashtable.PyObjectHashTable.get_item</span>\n  File <span class=\"nb\">&quot;pandas/_libs/hashtable_class_helper.pxi&quot;</span>, line <span class=\"m\">7096</span>, in <span class=\"n\">pandas._libs.hashtable.PyObjectHashTable.get_item</span>\n<span class=\"gr\">KeyError</span>: <span class=\"n\">&#39;card_id&#39;</span>\n\n<span class=\"gt\">The above exception was the direct cause of the following exception:</span>\n\n<span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/Users/benny.wong/.cache/uv/archive-v0/4URZ5lSNR81AX0mZB7D00/lib/python3.13/site-packages/marimo/_runtime/executor.py&quot;</span>, line <span class=\"m\">138</span>, in <span class=\"n\">execute_cell</span>\n<span class=\"w\">    </span><span class=\"n\">exec</span><span class=\"p\">(</span><span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">glbls</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"pm\">~~~~^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/var/folders/s8/xbv97fy15379pdpcf3npnv740000gp/T/marimo_794/__marimo__cell_emfo_.py&quot;</span>, line <span class=\"m\">2</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">duplicate_ids</span> <span class=\"o\">=</span> <span class=\"n\">df_raw</span><span class=\"p\">[</span><span class=\"s1\">&#39;card_id&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">duplicated</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">sum</span><span class=\"p\">()</span>\n<span class=\"w\">                    </span><span class=\"pm\">~~~~~~^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/Users/benny.wong/.cache/uv/archive-v0/4URZ5lSNR81AX0mZB7D00/lib/python3.13/site-packages/pandas/core/frame.py&quot;</span>, line <span class=\"m\">4113</span>, in <span class=\"n\">__getitem__</span>\n<span class=\"w\">    </span><span class=\"n\">indexer</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">columns</span><span class=\"o\">.</span><span class=\"n\">get_loc</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/benny.wong/.cache/uv/archive-v0/4URZ5lSNR81AX0mZB7D00/lib/python3.13/site-packages/pandas/core/indexes/base.py&quot;</span>, line <span class=\"m\">3819</span>, in <span class=\"n\">get_loc</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">)</span> <span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">err</span>\n<span class=\"gr\">KeyError</span>: <span class=\"n\">&#39;card_id&#39;</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "Hstk",
      "code_hash": "0c89c0f3d5d9c9eef264e709f7f484f6",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\n============================================================\nCATEGORICAL COLUMN VALUE COUNTS\n============================================================\n\n--- Type Distribution ---\ntype\nWater       1832\nFire        1611\nGrass       1542\nPsychic     1320\nElectric    1272\n            ... \nFlying       556\nPoison       431\nRock         415\nGround       397\nIce          300\nName: count, Length: 18, dtype: int64\n\n\u26a0\ufe0f  Notice the lowercase values? Data entry inconsistency!\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "nWHF",
      "code_hash": "bddd1318a0e00648bce02b3c87acc895",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\n============================================================\nOUTLIER DETECTION (Price)\n============================================================\nLower bound: $-2.48\nUpper bound: $4.92\nOutliers found: 2461\n\nTop 10 most expensive cards (potential outliers):\n             name      type       rarity  is_legendary  price_usd\n2235    Mismagius     Ghost  Secret Rare          True    2391.53\n3630        Budew     Grass  Secret Rare          True    1918.01\n12738     Flaaffy  Electric  Secret Rare          True    1149.85\n15804    Cacturne      Dark  Secret Rare          True    1112.34\n1198   Weepinbell     Grass  Secret Rare          True     889.48\n13544       Ho-Oh    Flying  Secret Rare          True     882.26\n13896     Walrein     Water  Secret Rare          True     866.33\n3460     Houndour      Dark  Secret Rare          True     839.76\n3241    Duraludon     Steel  Secret Rare          True     833.42\n12051     Geodude      Rock  Secret Rare          True     817.32\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "ZHCJ",
      "code_hash": "011decdb9494755ef09960701fb195a6",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "ROlb",
      "code_hash": "d95897d9e2d029f59606b2a34a834199",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u2705 Schema defined\n\nThis schema enforces:\n- card_id must be unique\n- type must be properly capitalized\n- Stats must be in reasonable ranges\n- generation must be 1-9\n- rarity must be one of the expected values\n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "qnkX",
      "code_hash": "4f261da3bb6671da698a0589f0bb0907",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "============================================================\nVALIDATING RAW DATA\n============================================================\n\u274c Validation failed!\n\nNumber of errors: 2950\n\nFirst 10 validation errors:\n       schema_context  column  \\\n2949  DataFrameSchema    None   \n1970           Column  rarity   \n1961           Column  rarity   \n1962           Column  rarity   \n1963           Column  rarity   \n1964           Column  rarity   \n1965           Column  rarity   \n1966           Column  rarity   \n1967           Column  rarity   \n1968           Column  rarity   \n\n                                                  check check_number  \\\n2949                                column_in_dataframe         None   \n1970  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1961  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1962  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1963  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1964  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1965  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1966  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1967  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n1968  isin(['Common', 'Uncommon', 'Rare', 'Ultra Rar...            0   \n\n      failure_case  index  \n2949       card_id   None  \n1970     Rare Holo  10524  \n1961     Rare Holo  10486  \n1962     Rare Holo  10487  \n1963     Rare Holo  10491  \n1964     Rare Holo  10499  \n1965     Rare Holo  10501  \n1966     Rare Holo  10504  \n1967     Rare Holo  10505  \n1968  Rare Holo GX  10508  \n",
          "mimetype": "text/plain"
        }
      ]
    },
    {
      "id": "Vxnm",
      "code_hash": "6d1945ac04c5eed615025fa14f26d9f1",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "Index(['card_id'], dtype='object')",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/var/folders/s8/xbv97fy15379pdpcf3npnv740000gp/T/marimo_794/__marimo__cell_Vxnm_.py&quot;</span>, line <span class=\"m\">55</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">df_clean</span> <span class=\"o\">=</span> <span class=\"n\">clean_pokemon_data</span><span class=\"p\">(</span><span class=\"n\">df_raw</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/var/folders/s8/xbv97fy15379pdpcf3npnv740000gp/T/marimo_794/__marimo__cell_Vxnm_.py&quot;</span>, line <span class=\"m\">21</span>, in <span class=\"n\">clean_pokemon_data</span>\n<span class=\"w\">    </span><span class=\"n\">df_clean</span> <span class=\"o\">=</span> <span class=\"n\">df_clean</span><span class=\"o\">.</span><span class=\"n\">drop_duplicates</span><span class=\"p\">(</span><span class=\"n\">subset</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;card_id&#39;</span><span class=\"p\">],</span> <span class=\"n\">keep</span><span class=\"o\">=</span><span class=\"s1\">&#39;first&#39;</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/Users/benny.wong/.cache/uv/archive-v0/4URZ5lSNR81AX0mZB7D00/lib/python3.13/site-packages/pandas/core/frame.py&quot;</span>, line <span class=\"m\">6840</span>, in <span class=\"n\">drop_duplicates</span>\n<span class=\"w\">    </span><span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">duplicated</span><span class=\"p\">(</span><span class=\"n\">subset</span><span class=\"p\">,</span> <span class=\"n\">keep</span><span class=\"o\">=</span><span class=\"n\">keep</span><span class=\"p\">)]</span>\n<span class=\"w\">                   </span><span class=\"pm\">~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/Users/benny.wong/.cache/uv/archive-v0/4URZ5lSNR81AX0mZB7D00/lib/python3.13/site-packages/pandas/core/frame.py&quot;</span>, line <span class=\"m\">6972</span>, in <span class=\"n\">duplicated</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"ne\">KeyError</span><span class=\"p\">(</span><span class=\"n\">Index</span><span class=\"p\">(</span><span class=\"n\">diff</span><span class=\"p\">))</span>\n<span class=\"gr\">KeyError</span>: <span class=\"n\">Index([&#39;card_id&#39;], dtype=&#39;object&#39;)</span>\n</pre></div>\n</span>",
          "mimetype": "application/vnd.marimo+traceback"
        }
      ]
    },
    {
      "id": "DnEU",
      "code_hash": "14e5193875bd3e8a500984d42b6fe930",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (KeyError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "ulZA",
      "code_hash": "5bcfd97f99d955886a905cc48e4916f8",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (KeyError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Pvdt",
      "code_hash": "50d34b3f67eace480815746a14e1e9af",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (KeyError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "aLJB",
      "code_hash": "460285878f00990c2110051af28d783d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "nHfw",
      "code_hash": "b27280f0e438f3d7715c62d05989ba3b",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (KeyError): ",
          "traceback": []
        }
      ],
      "console": []
    }
  ]
}